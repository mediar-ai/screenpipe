---
title: "architecture"
sidebarTitle: "architecture"
description: "How screenpipe captures screens, processes OCR, stores data locally in SQLite, and provides APIs for AI."
icon: "sitemap"
---

## overview

screenpipe is a Rust application that continuously captures your screen and audio, processes them locally, and stores everything in a SQLite database. it serves a REST API on `localhost:3030` for querying your data.

```mermaid
graph LR
    subgraph capture["capture"]
        S[screen]
        A[audio]
        U[UI events]
    end

    subgraph process["processing"]
        OCR[OCR]
        STT[speech-to-text]
        SID[speaker ID]
    end

    subgraph store["storage"]
        DB[(SQLite)]
        FS[media files]
    end

    subgraph serve["API · localhost:3030"]
        REST[REST API]
        MCP[MCP server]
        WS[WebSocket]
    end

    S --> OCR
    A --> STT
    A --> SID
    U --> DB

    OCR --> DB
    STT --> DB
    S --> FS
    A --> FS

    DB --> REST
    DB --> MCP
    FS --> WS

    REST --> P[pipes / AI agents]
    MCP --> AI[Claude · Cursor · etc.]
```

## data flow

```mermaid
sequenceDiagram
    participant Screen
    participant Audio
    participant OCR/STT
    participant SQLite
    participant API
    participant AI

    loop every frame (1 FPS)
        Screen->>OCR/STT: frame
        OCR/STT->>SQLite: extracted text + metadata
        Screen->>SQLite: MP4 recording
    end

    loop every 30s chunk
        Audio->>OCR/STT: audio chunk
        OCR/STT->>SQLite: transcription + speaker
        Audio->>SQLite: audio file
    end

    AI->>API: search query
    API->>SQLite: SQL lookup
    SQLite-->>API: results
    API-->>AI: JSON response
```

## crates

screenpipe is a Rust workspace with specialized crates:

```mermaid
graph TD
    APP[screenpipe-app-tauri<br/><i>desktop app</i>]
    SERVER[screenpipe-server<br/><i>REST API · routes</i>]
    DB[screenpipe-db<br/><i>SQLite · types</i>]
    VISION[screenpipe-vision<br/><i>screen capture · OCR</i>]
    AUDIO[screenpipe-audio<br/><i>audio capture · STT</i>]
    CORE[screenpipe-core<br/><i>pipes · config</i>]
    EVENTS[screenpipe-events<br/><i>event system</i>]
    A11Y[screenpipe-accessibility<br/><i>UI events · macOS</i>]
    AI[screenpipe-apple-intelligence<br/><i>Foundation Models</i>]
    INT[screenpipe-integrations<br/><i>MCP · reminders</i>]

    APP --> SERVER
    APP --> AI
    SERVER --> DB
    SERVER --> VISION
    SERVER --> AUDIO
    SERVER --> CORE
    SERVER --> EVENTS
    AUDIO --> DB
    VISION --> DB
    CORE --> DB
    A11Y --> DB
    INT --> SERVER
```

## layers

### 1. capture

| what | how | crate |
|------|-----|-------|
| **screen** | per-monitor frame capture at configurable FPS (default 1.0, macOS 0.5) | `screenpipe-vision` |
| **audio** | multiple input/output devices in configurable chunks (default 30s) | `screenpipe-audio` |
| **UI events** | keyboard, mouse, app switches, clipboard via accessibility APIs | `screenpipe-accessibility` |

### 2. processing

| engine | type | platform |
|--------|------|----------|
| Apple Vision | OCR | macOS |
| Windows native | OCR | Windows |
| Tesseract | OCR | cross-platform fallback |
| Whisper | speech-to-text | local, all platforms |
| Deepgram | speech-to-text | cloud API |

additional processing: speaker identification, PII redaction, frame deduplication (skips identical frames).

### 3. storage

all data stays local on your machine:

- **SQLite** at `~/.screenpipe/db.sqlite` — metadata, OCR text, transcriptions, speakers, tags
- **media** at `~/.screenpipe/data/` — MP4 screen recordings, audio chunks

### 4. API

REST API on `localhost:3030`:

| endpoint | description |
|----------|-------------|
| `/search` | filtered content retrieval (OCR, audio, UI events) |
| `/search/keyword` | keyword search with text positions |
| `/frames/{id}` | access captured frames |
| `/health` | system status and metrics |
| `/raw_sql` | direct database queries |
| `/ai/chat/completions` | Apple Intelligence (macOS 26+) |

see [CLI reference](/cli-reference) for the full endpoint list.

### 5. pipes

[pipes](/pipes) are AI agents (`.md` prompt files) that run on your screen data. they're executed by an AI agent that reads the prompt, queries the screenpipe API, and takes action.

pipes live in `~/.screenpipe/pipes/{name}/` and run on cron-like schedules.

### 6. desktop app

the desktop app is built with **Tauri** (Rust backend) + **Next.js** (React frontend):

```mermaid
graph LR
    subgraph tauri["Tauri shell"]
        RS[Rust backend<br/>commands · permissions · tray]
        WV[WebView]
    end

    subgraph frontend["Next.js frontend"]
        PAGES[pages<br/>chat · timeline · settings]
        STORE[Zustand stores]
        UI[shadcn/ui components]
    end

    subgraph backend["screenpipe-server"]
        API[REST API :3030]
    end

    RS --> WV
    WV --> PAGES
    PAGES --> STORE
    STORE --> UI
    PAGES --> API
```

## database schema

key tables:

| table | stores |
|-------|--------|
| `frames` | captured screen frame metadata |
| `ocr_results` | text extracted from frames |
| `audio_chunks` | audio recording metadata |
| `transcriptions` | text from audio |
| `speakers` | identified speakers |
| `ui_events` | keyboard, mouse, clipboard events |
| `tags` | user-applied tags on content |

inspect directly:

```bash
sqlite3 ~/.screenpipe/db.sqlite .schema
```

## resource usage

runs 24/7 on a MacBook Pro M3 (32 GB) or a $400 Windows laptop:

| metric | typical value |
|--------|---------------|
| RAM | ~600 MB |
| CPU | ~10% |
| storage | ~30 GB/month at 1 FPS |

## source code

| component | path |
|-----------|------|
| API server | [screenpipe-server/src/](https://github.com/screenpipe/screenpipe/tree/main/crates/screenpipe-server/src) |
| screen capture | [screenpipe-vision/src/core.rs](https://github.com/screenpipe/screenpipe/blob/main/crates/screenpipe-vision/src/core.rs) |
| audio capture | [screenpipe-audio/src/](https://github.com/screenpipe/screenpipe/tree/main/crates/screenpipe-audio/src) |
| database | [screenpipe-db/src/db.rs](https://github.com/screenpipe/screenpipe/blob/main/crates/screenpipe-db/src/db.rs) |
| pipes | [screenpipe-core/src/pipes/](https://github.com/screenpipe/screenpipe/tree/main/crates/screenpipe-core/src/pipes) |
| MCP server | [screenpipe-mcp/src/index.ts](https://github.com/screenpipe/screenpipe/blob/main/crates/screenpipe-integrations/screenpipe-mcp/src/index.ts) |
| desktop app | [screenpipe-app-tauri/](https://github.com/screenpipe/screenpipe/tree/main/apps/screenpipe-app-tauri) |
